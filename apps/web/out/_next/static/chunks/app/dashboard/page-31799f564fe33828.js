(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{9140:function(e,a,s){Promise.resolve().then(s.bind(s,4591))},4591:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return o}});var t=s(7437),r=s(2265),l=s(7138),d=s(8706),n=s(6530),c=s(6264);function i(){return Promise.all([(0,c.AK)(),(0,c.Oj)("12w")])}function o(){let{t:e,translateExplain:a}=(0,n.b)(),[s,o]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[h,b]=(0,r.useState)(!0),[u,p]=(0,r.useState)(null),[g,N]=(0,r.useState)(!1),[j,f]=(0,r.useState)(null),[v,y]=(0,r.useState)(!1),[w,k]=(0,r.useState)("");(0,r.useEffect)(()=>{i().then(e=>{let[a,s]=e;o(a),x(s.data||[])}).catch(e=>p(e.message)).finally(()=>b(!1))},[]);let C=(0,r.useCallback)(async e=>{f(null),N(!0);try{await (0,c.JB)(e),y(!1),k("");let[a,s]=await i();o(a),x(s.data||[]),p(null)}catch(a){let e=a instanceof Error?a.message:String(a);e.includes("Cron secret required")?y(!0):f(e)}finally{N(!1)}},[]);if(h)return(0,t.jsx)("div",{className:"p-8",children:e("common.loading")});if(u)return(0,t.jsxs)("main",{className:"min-h-screen p-8 max-w-6xl mx-auto",children:[(0,t.jsx)(d.l,{}),(0,t.jsxs)("div",{className:"mb-4 text-red-600",children:[e("common.error"),": ",u]}),(0,t.jsx)("p",{className:"mb-4 text-sm text-gray-600",children:e("dashboard.errorHint")}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>C(),disabled:g,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:g?e("dashboard.running"):e("dashboard.runJobs")}),j&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:j})]}),v&&(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2 rounded-lg border border-amber-200 bg-amber-50 p-3 text-amber-800",children:[(0,t.jsx)("label",{htmlFor:"cron-secret-err",className:"text-sm font-medium",children:e("dashboard.cronSecretLabel")}),(0,t.jsx)("input",{id:"cron-secret-err",type:"password",value:w,onChange:e=>k(e.target.value),placeholder:e("dashboard.cronSecretPlaceholder"),className:"rounded border border-amber-300 px-2 py-1 text-sm"}),(0,t.jsx)("button",{type:"button",onClick:()=>C(w),disabled:g||!w.trim(),className:"rounded bg-amber-600 px-3 py-1 text-sm text-white hover:bg-amber-700 disabled:opacity-50",children:e("dashboard.runWithSecret")})]})]});if(!s)return null;let S=e=>"GREEN"===e?"text-green-600":"RED"===e?"text-red-600":"YELLOW"===e?"text-amber-500":"text-gray-400",L=e=>"RISING"===e?"↑":"FALLING"===e?"↓":"→";return(0,t.jsxs)("main",{className:"min-h-screen p-8 max-w-6xl mx-auto",children:[(0,t.jsx)(d.l,{}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:e("dashboard.title")}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e("dashboard.asOf"),": ",new Date(s.asOf).toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>C(),disabled:g,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:g?e("dashboard.running"):e("dashboard.runJobs")}),j&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:j})]})]}),v&&(0,t.jsxs)("div",{className:"mb-6 flex flex-wrap items-center gap-2 rounded-lg border border-amber-200 bg-amber-50 p-3 text-amber-800",children:[(0,t.jsx)("label",{htmlFor:"cron-secret",className:"text-sm font-medium",children:e("dashboard.cronSecretLabel")}),(0,t.jsx)("input",{id:"cron-secret",type:"password",value:w,onChange:e=>k(e.target.value),placeholder:e("dashboard.cronSecretPlaceholder"),className:"rounded border border-amber-300 px-2 py-1 text-sm"}),(0,t.jsx)("button",{type:"button",onClick:()=>C(w),disabled:g||!w.trim(),className:"rounded bg-amber-600 px-3 py-1 text-sm text-white hover:bg-amber-700 disabled:opacity-50",children:e("dashboard.runWithSecret")}),(0,t.jsx)("button",{type:"button",onClick:()=>{y(!1),f(null)},className:"text-sm underline",children:e("dashboard.cancel")})]}),(0,t.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[(0,t.jsx)("h2",{className:"text-sm font-medium text-gray-500",children:e("dashboard.weeklyScore")}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:s.score}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e("dashboard.deltaWeek"),": ",s.deltaWeek>=0?"+":"",s.deltaWeek]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[(0,t.jsx)("h2",{className:"text-sm font-medium text-gray-500",children:e("dashboard.scoreHistory")}),(0,t.jsx)("div",{className:"flex items-end gap-0.5 h-12 mt-2",children:m.slice(-12).map(e=>(0,t.jsx)("div",{className:"flex-1 bg-blue-200 rounded-t min-w-[4px]",style:{height:"".concat(Math.max(8,Number(e.score)/8*100),"%")},title:"".concat(e.week_start_date,": ").concat(e.score)},e.week_start_date))})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[(0,t.jsx)("h2",{className:"text-sm font-medium text-gray-500",children:e("dashboard.scenario")}),(0,t.jsxs)("p",{className:"font-medium",children:[e("dashboard.bull"),": ",e("dashboard.scenarioValue.bull."+s.scenario.bull)]}),(0,t.jsxs)("p",{className:"font-medium",children:[e("dashboard.bear"),": ",e("dashboard.scenarioValue.bear."+s.scenario.bear)]})]})]}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:e("dashboard.indicators")}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.indicators.map(s=>(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("span",{className:"font-medium",children:s.key}),(0,t.jsxs)("span",{className:S(s.status),title:e("status."+s.status.toLowerCase()),"aria-label":e("status."+s.status.toLowerCase()),children:["GREEN"===s.status&&(0,t.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"RED"===s.status&&(0,t.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"YELLOW"===s.status&&(0,t.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"UNKNOWN"===s.status&&(0,t.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-.A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})]})]}),null!=s.value&&(0,t.jsx)("p",{className:"text-lg mt-1",children:s.value}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[L(s.trend)," ",e("trend."+s.trend.toLowerCase())]}),s.explain&&(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:a(s.explain)}),"UNKNOWN"===s.status&&"Data stale"===s.explain&&(0,t.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:e("dashboard.staleHint")}),e("dashboard.favorable."+s.key)!=="dashboard.favorable."+s.key&&(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-2 pt-2 border-t border-gray-100",children:e("dashboard.favorable."+s.key)}),(0,t.jsx)(l.default,{href:"/indicators/".concat(s.key),className:"text-xs text-blue-600 mt-2 inline-block hover:underline",children:e("dashboard.viewHistory")})]},s.key))}),0===s.indicators.length&&(0,t.jsxs)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4 text-amber-800",children:[(0,t.jsx)("p",{className:"font-medium",children:e("dashboard.noIndicators")}),(0,t.jsx)("p",{className:"mt-1 text-sm",children:e("dashboard.noIndicatorsHint")}),(0,t.jsx)("p",{className:"mt-2 text-xs text-amber-700",children:e("dashboard.apiKeysHint")})]})]})}}},function(e){e.O(0,[138,67,971,23,744],function(){return e(e.s=9140)}),_N_E=e.O()}]);