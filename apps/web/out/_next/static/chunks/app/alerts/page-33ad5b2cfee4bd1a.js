(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{2930:function(e,t,n){Promise.resolve().then(n.bind(n,3427))},3427:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var a=n(7437),s=n(2265),r=n(8706),l=n(6530),i=n(6264);function c(){let{t:e}=(0,l.b)(),[t,n]=(0,s.useState)([]),[c,o]=(0,s.useState)([]),[u,d]=(0,s.useState)(!0),[h,f]=(0,s.useState)(null);return((0,s.useEffect)(()=>{Promise.all([(0,i.hE)("30d"),(0,i.j)()]).then(e=>{let[t,a]=e;n(Array.isArray(t)?t:[]),o(Array.isArray(a)?a:[])}).catch(e=>f(e.message)).finally(()=>d(!1))},[]),u)?(0,a.jsx)("div",{className:"p-8",children:e("common.loading")}):h?(0,a.jsxs)("div",{className:"p-8 text-red-600",children:[e("common.error"),": ",h]}):(0,a.jsxs)("main",{className:"min-h-screen p-8 max-w-4xl mx-auto",children:[(0,a.jsx)(r.l,{}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:e("alerts.title")}),(0,a.jsxs)("section",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:e("alerts.rules")}),(0,a.jsx)("ul",{className:"space-y-2",children:c.map(t=>{var n,s;return(0,a.jsxs)("li",{className:"border rounded p-3 flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-mono text-sm",children:String(null!==(s=null===(n=t.json_rule)||void 0===n?void 0:n.name)&&void 0!==s?s:t.id)}),(0,a.jsx)("span",{className:t.is_enabled?"text-green-600":"text-gray-400",children:t.is_enabled?e("alerts.on"):e("alerts.off")})]},t.id)})}),0===c.length&&(0,a.jsx)("p",{className:"text-gray-500",children:e("alerts.noRules")})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:e("alerts.firedAlerts")}),(0,a.jsx)("ul",{className:"space-y-2",children:t.map(e=>{var t;return(0,a.jsxs)("li",{className:"border rounded p-3 text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:new Date(e.ts).toLocaleString()}),(0,a.jsx)("pre",{className:"mt-1 overflow-auto",children:JSON.stringify(null!==(t=e.payload)&&void 0!==t?t:{},null,0)})]},e.id)})}),0===t.length&&(0,a.jsx)("p",{className:"text-gray-500",children:e("alerts.noFired")})]})]})}},8706:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var a=n(7437),s=n(2265),r=n(7138),l=n(6463),i=n(6530),c=n(6881);function o(){let{t:e,locale:t,setLocale:n}=(0,i.b)(),o=(0,l.useRouter)(),[u,d]=(0,s.useState)(null);async function h(){await (0,c.M)().auth.signOut(),o.push("/login"),o.refresh()}return(0,s.useEffect)(()=>{(0,c.M)().auth.getSession().then(e=>{let{data:{session:t}}=e;return d(!!t)});let{data:{subscription:e}}=(0,c.M)().auth.onAuthStateChange(()=>{(0,c.M)().auth.getSession().then(e=>{let{data:{session:t}}=e;return d(!!t)})});return()=>e.unsubscribe()},[]),(0,a.jsxs)("nav",{className:"mb-8 flex flex-wrap items-center gap-4",children:[!0===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.default,{href:"/dashboard",className:"text-blue-600 hover:underline",children:e("nav.dashboard")}),(0,a.jsx)(r.default,{href:"/indicators",className:"text-blue-600 hover:underline",children:e("nav.indicators")}),(0,a.jsx)(r.default,{href:"/alerts",className:"text-blue-600 hover:underline",children:e("nav.alerts")}),(0,a.jsx)("button",{type:"button",onClick:h,className:"text-blue-600 hover:underline ml-auto",children:e("nav.logout")})]}),(!1===u||null===u)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.default,{href:"/login",className:"text-blue-600 hover:underline",children:e("nav.login")}),(0,a.jsx)(r.default,{href:"/signup",className:"text-blue-600 hover:underline",children:e("nav.signup")}),(0,a.jsx)("span",{className:"ml-auto"})]}),(0,a.jsxs)("span",{className:"ml-auto flex gap-2 text-sm",children:[(0,a.jsx)("button",{type:"button",onClick:()=>n("es"),className:"es"===t?"font-semibold text-blue-600 underline":"text-gray-600 hover:text-blue-600","aria-pressed":"es"===t,children:"ES"}),(0,a.jsx)("span",{className:"text-gray-400","aria-hidden":!0,children:"|"}),(0,a.jsx)("button",{type:"button",onClick:()=>n("en"),className:"en"===t?"font-semibold text-blue-600 underline":"text-gray-600 hover:text-blue-600","aria-pressed":"en"===t,children:"EN"})]})]})}},6264:function(e,t,n){"use strict";var a;n.d(t,{AK:function(){return l},JB:function(){return d},Oj:function(){return c},cS:function(){return i},hE:function(){return o},j:function(){return u}});let s=null!==(a=n(357).env.NEXT_PUBLIC_API_URL)&&void 0!==a?a:"";async function r(e){if(e.ok)return;let t=await e.text(),n=t||e.statusText;try{let e=JSON.parse(t);"string"==typeof(null==e?void 0:e.error)&&(n=e.error)}catch(e){}throw Error(n)}async function l(e){let t=e?"?timezone=".concat(encodeURIComponent(e)):"",n=await fetch("".concat(s,"/api/dashboard/today").concat(t));return await r(n),n.json()}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"30d",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1d",a=await fetch("".concat(s,"/api/indicators/").concat(encodeURIComponent(e),"/history?range=").concat(t,"&granularity=").concat(n));return await r(a),a.json()}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"12w",t=await fetch("".concat(s,"/api/score/history?range=").concat(e));return await r(t),t.json()}async function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"30d",t=await fetch("".concat(s,"/api/alerts/history?range=").concat(e));return await r(t),t.json()}async function u(){let e=await fetch("".concat(s,"/api/rules"));return await r(e),e.json()}async function d(e){let t={};e&&(t["X-Cron-Secret"]=e);let n=await fetch("".concat("","/.netlify/functions/run-jobs"),{method:"POST",headers:t});if(401===n.status)throw Error("Cron secret required. Set CRON_SECRET in Netlify and enter it when prompted.");return await r(n),n.json().catch(()=>({ok:!0}))}}},function(e){e.O(0,[497,138,836,971,23,744],function(){return e(e.s=2930)}),_N_E=e.O()}]);